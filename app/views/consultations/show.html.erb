








<div class="ecg-flex-container" style="margin-bottom:3rem;">
    <h1>Analysis results</h1>
</div>

<div class="ecg-flex-container">




    <div class="capsuleLeft scale-up-bl">

      <div class="ekg-details">
        <h3>Patient informations:</h3>
          <div class="ekg-list">
            <p>First Name:<%= @consultation.patient.first_name %></p>
            <p>Last name:<%= @consultation.patient.last_name %> </p>
            <p>Birth date:<%= @consultation.patient.birth_date%></p>
            <p><%= @consultation.patient.height%>cm</p>
          </div>

      </div>


      <div style="background-color:white; border-radius:1rem; padding:1rem;">
      <%= line_chart @data, min: 500, points: false %>
      </div>

      <div class="ekg-details">
          <div class="ekg-list">
            <div style="animation-delay:0ms;" class="scale-up-bl bpm"><strong><%= 60_000 / @intervals_in_ms.max %></strong><p>BPM</p>
            <%= image_tag "courb.svg", alt: "courbe", width: 100 %></div>
            <div class="splitVertical">
              <div style="animation-delay:500ms;" class="scale-up-bl interval alerteRouge">
              <strong><%= @intervals_in_ms.max %></strong><p>Interval</br> max</p></div>
              <div style="animation-delay:600ms;" class="scale-up-bl interval alerteOrange">
              <strong><%= @intervals_in_ms.min %></strong><p>Interval</br>min </p></div>
            </div>
            <div class="splitVertical">
              <div style="animation-delay:700ms;" class="scale-up-bl interval alerteVerte"><strong><%= @intervals_in_ms.max - @intervals_in_ms.min %></strong><p>Delta ▲△</p></div>
              <div style="animation-delay:800ms;" class="scale-up-bl interval alerteVerte"><strong>FA</strong><p>Type</p></div>
            </div>
          </div>




      </div>


    <% if @consultation.diagnostic == "red" %>
            <div class="alerte rouge">
            <span class="exclamation">!</span><p> WARNING : This EKG has abnormal high frequency. <br>A cardiologist will contact you.  </p>
          </div>
    </div>
      <div class="capsuleRight scale-up-br">
        <div class="consultation" data-controller="consultation-subscription" data-consultation-subscription-consultation-id-value=" <%= @consultation.id %>">
        <%= render "chat" %>
        </div>

    <% elsif @consultation.diagnostic == "orange" %>
              <div class="alerte orange">
            <span class="exclamation">!</span><p> WARNING : This EKG has irregular frequency.A checkup with a specialist is recommended.  </p>
          </div>
          </div>
      <div class="capsuleRight scale-up-br">
      <%#= @consultation.diagnostic %>
        <div class="consultation" data-controller="consultation-subscription" data-consultation-subscription-consultation-id-value=" <%= @consultation.id %>">
          <%= render "enveloppe" %>
          <%= form_with url: send_mail_path do |form| %>
            <%= form.label :mail, "Email:" %>
            <%= form.text_field :mail %>
            <%= form.submit "Send" %>
          <% end %>

          <div data-controller="search-cardio">
            <%= form_with url: consultation_search_cardio_path(@consultation),  html: {data: {search_cardio_target: "form"}} do |form| %>
              <%= form.label :place, "Place:" %>
              <%= form.text_field :place, value: params[:place], data: {search_cardio_target: "input"} %>
              <%= form.submit "Send", data: {action: "click->search-cardio#update"} %>
            <% end %>
            </div>

            <div><%= render 'cardiologists' %></div>
          </div>
      </div>
    <% else %>

          <div class="alerte verte">
            <span class="exclamation">!</span><p> This EKG does not show any issues.</p>
          </div>


  </div>
    <% end %>








</div> <!-- end ecg flex container -->
